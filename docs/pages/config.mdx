# MUD config

Certain CLI commands, such as [`mud tablegen`](/cli/tablegen) and [`mud worldgen`](/cli/worldgen) require the MUD configuration file.
This file needs to be named `mud.config.ts` and be in the same folder as your `foundry.toml` file.

The config is used to define:

- The tables in your project in the `tables` object of your configuration.
- The [namespace](/world/namespaces-access-control) that [systems](/world/systems) and tables will be deployed in.
- The `System`s in your project.
  By default, the deployer will find all Solidity matching `*System.sol` (so any file ending in `System.sol`, in any folder) and deploy them as public `System`.
  If you want greater control over your systems (to change their public access or their name), you can use the `systems` object in the config.
- The [modules](/world/modules) that will be installed in the `World`.

The is an example of a `World` config:

```tsx
import { defineWorld } from "@latticexyz/world";

// Used for the module parameters, not required otherwise.
// If you use this, make sure to run:
//
// pnpm install @latticexyz/common
//
// In the packages/contracts directory.
import { resolveTableId } from "@latticexyz/config/register";

export default defineWorld({
  enums: {
    TerrainType: ["None", "TallGrass", "Boulder"],
  },
  excludeSystems: ["System3", "System2"],
  worldContractName: "CustomWorld",
  namespace: "mud",
  systems: {
    IncrementSystem: {
      name: "increment",
      openAccess: true,
    },
  },
  tables: {
    Counter: {
      schema: {
        value: "uint32",
      },
      key: [],
    },
    Tasks: {
      schema: {
        id: "bytes32",
        createdAt: "uint256",
        completedAt: "uint256",
        description: "string",
      },
      key: ["id"],
    },
  },
  deploysDirectory: "./mud-deploys",
  modules: [
    {
      name: "KeysWithValueModule",
      artifactPath: "@latticexyz/world-modules/out/KeysWithValueModule.sol/KeysWithValueModule.json",
      root: true,
      args: [resolveTableId("Tasks")],
    },
  ],
});
```

## Global configuration keys

The global configuration keys are all optional.

- **`namespace`**: a `string`: which namespace to deploy the resources defined in the config into.
  The default value is the ROOT namespace.

- **`tables`**: a record of tables. The keys in the record are table names.
  The value is a record of [table properties](https://github.com/latticexyz/mud/blob/main/packages/store/ts/config/storeConfig.ts#L110-L135).

  - **`schema`** (record):
    The keys of this record are the field names in the data, which includes both the key fields and the value fields.
    By convention, these keys start with a lowercase letter.
    The values are strings that contain the data types of the fields.
    Note that this is the sole required field, all the others are optional.

  - **`key`** (list):
    A list of the `schema` fields that are the key for that table.
    If you want a singleton table, use an empty list (as in `Counter` table above).

  - **`type`** (either `table` or `offchainTable`): [The table type](/store/tables#types-of-tables).
    The default is `table`, which is a table stored onchain.
    If you specify `offchainTable`, the table's data is only available offchain through events.

- **`systems`**: a record of system definitions. The keys in the record are file names without the `.sol` extension. For example, if your system is named `TestSystem.sol`, use `TestSystem` as the key.

  The value is a record of system configuration properties:

  - `registerFunctionSelectors` (optional, default `true`): a `bool`.
    Whether we want to automatically register the `public` functions of the `System` as
    [function selectors](/world/function-selectors)
  - `openAccess` (optional, default `true`): a `bool`.
    If set to `false`, only the systems in the same namespace and the addresses or systems listed in the `accessList` array have access.
  - `accessList` (required if openAccess is `false`): an array of `string`. Each address in the array will be granted access to this system, allowing them to call it.

- **`enums`**: a record of [enumerations](https://solidity-by-example.org/enum/).
  The keys are the names of the enumerations.
  The values are arrays of the strings for the values the enumeration can take.

- **`excludeSystems`**: an array of `string`: which systems to not deploy, even if their name ends with “System”.

- **`codegen`**: a record of code generation options.

  - **`worldInterfaceName`** a `string`: The name of the interface for the `World`.
    The default value is `IWorld`.
  - **`worldgenDirectory`** a `string`: The directory for system and world interfaces.
    The default value is `world`.

- **`deploy`**: a record of deployment options.

  - **`postDeployScript`** a `string`: Script to execute after the deployment is complete.
    This script must be placed in the forge scripts directory (see `foundry.toml`) and have a `.s.sol` extension.
    The default is `PostDeploy`.

  - **`deploysDirectory`** a `string`: Which folder to put the deployment artifacts into after deployment.
    The default is `./deploys`.

  - **`worldsFile`** a `string`: JSON file for the chain to `World` deploy address mapping.
    The default is `./worlds.json`.

  - <a id="upgradeableWorldImplementation" />
    **`upgradeableWorldImplementation`** a `bool`: Whether the `World` is to be deployed behind a proxy to [enable upgrades
    of the core World implementation](/world/upgrades). The default is `false`.

- **`modules`**: a list of modules to be installed into the `World`.
  Each entry in this list is a record with these fields:

  - **`name`** a `string`: The name of the module.
  - **`artifactPath`** a `string`: The path to the compiled version of the contract with the module.
    In our case, [the module](https://github.com/latticexyz/mud/blob/main/packages/world-modules/src/modules/keyswithvalue/KeysWithValueModule.sol) is part of MUD's [`@latticexyz/world-modules`](https://github.com/latticexyz/mud/tree/main/packages/world-modules) package.
  - **`root`** a `bool`: Whether the module is to run with the same permissions as [a `System` in the root namespace](/world/systems#root-systems) or not.
    Only set to `true` when necessary (for example, to add hooks to a table in a different namspace).
  - **`args`** a list of arguments to the module, each of which is a record with two keys:

    - **`type`** a string: the Solidity type for the variable.
    - **`value`** the value of the argument.

    If the argument needs to be a [`ResourceId`](/world/resource-ids), you can create it using either `resourceToHex` or `resolveTableId`.

    <details>

    <summary>Use `resolveTableId` to refer to a table defined in the same configuration file.</summary>

    1. Install the `@latticexyz/config` package.

       ```sh
       cd packages/contracts
       pnpm install @latticexyz/config
       ```

    1. In `mud.config.ts`, import `resolveTableId`.

       ```typescript
       import { resolveTableId } from "@latticexyz/world/internal";
       ```

    1. Use this syntax for `args`.
       The return value is the entire record required for the argument, `type` and `value`.

       ```typescript
       args: [resolveTableId("app__Tasks")];
       ```

    </details>

    <details>

    <summary>Use `resourceToHex` to specify the full resource information.</summary>

    1. Install the `@latticexyz/common` package.

       ```sh
       cd packages/contracts
       pnpm install @latticexyz/common
       ```

    1. In `mud.config.ts`, import `resourceToHex`.

       ```typescript
       import { resourceToHex } from "@latticexyz/common";
       ```

    1. Use this syntax for `args`:

       ```typescript
             args: [
                     {
                       type: "bytes32",
                       value: resourceToHex({
                         type: "table",
                         namespace: "app",
                         name: "Tasks",
                       }),
                     },
                   ],
       ```

    </details>
